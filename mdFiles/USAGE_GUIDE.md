# 📖 Using Money Manager - Usage Guide

## 🚀 Quick Start

### 1. הוסיפו חשבון בנקאי

1. כנסו לתבנית ל-**Actions** בריפוזיטוריום
2. בחרו **Add Account**
3. לחצו **Run workflow**
4. בחלק "Use workflow from":
   - בחרו **Branch: main**

5. מלאו את הטופס:

#### בחירת הבנק

בחרו מתוך רשימה:
- `hapoalim` - בנק הפועלים
- `leumi` - בנק לאומי
- `mizrahi` - בנק מזרחי
- `discount` - בנק דיסקאונט
- `mercantile` - בנק מרכנטיל
- `max` - מקס
- `visaCal` - ויזה כאל
- `isracard` - אסרכרט
- `amex` - אמקס
- `union` - איגוד
- `beinleumi` - בינלאומי
- וכו'...

#### מילוי פרטים

בהתאם לבנק שבחרתם, מלאו את השדות הרלוונטיים:

**בנק הפועלים:**
- User Code: קוד המשתמש שלכם
- Password: הסיסמה שלכם

**בנק לאומי / מזרחי / וכו':**
- Username: שם משתמש
- Password: סיסמה

**בנקים עם קוד זהות:**
- ID: תז
- Password: סיסמה
- Num: מספר סניף / חשבון (אם נדרש)

**כרטיסים (Isracard, Amex):**
- ID: תז
- Card 6 Digits: 6 ספרות אחרונות של הכרטיס
- Password: סיסמה

**One Zero:**
- Email: אימייל
- Password: סיסמה
- Phone Number: מספר טלפון
- OTP Code Retriever: OTP שקיבלתם
- Long Term Token: טוקן ארוך טווח (אם זמין)

6. לחצו **Run workflow**
7. המתן להשלמת הריצה

#### בדיקת התוצאות

בתום הריצה:
- ✅ אם הכל בסדר: תראו `Account created with ID: xxxxx`
- ❌ אם יש שגיאה: תראו הודעת שגיאה עם סיבה

**שמרו את ה-Account ID** - תצטרכו אותו בשביל סריקות

---

## 📊 סריקת עסקאות

### סוגי סריקה

#### 1. **Regular** (רגילה)
- סורקת 3 החודשים האחרונים
- מידי פעם שבאתם לעדכן נתונים

**Use case:** ריצה יומית או שבועית

#### 2. **Update** (עדכון)
- סורקת מהתאריך של העדכון האחרון
- מהר יותר מ-regular
- חסכון bandwidth

**Use case:** ריצה יומית לאחר סריקה ראשונית

#### 3. **Deep** (עמוקה)
- סורקת הכל החל מ-2015
- יכולה להיות איטית מאוד
- שימוש חד-פעמי

**Use case:** import ראשוני של כל ההיסטוריה

#### 4. **Custom** (מותאמת אישית)
- בחרו תאריך התחלה בעצמכם
- בפורמט ISO: `YYYY-MM-DD`

**Use case:** סריקה חלקית של תקופה מסוימת

### ריצת סריקה

1. כנסו ל-**Actions** → **Scrape Transactions**
2. לחצו **Run workflow**
3. מלאו:
   - **Account ID:** ה-ID שקיבלתם בעת יצירת החשבון
   - **Scraping Mode:** בחרו מתוך 4 אפשרויות
   - **Start Date:** (אם בחרתם custom)

4. לחצו **Run workflow**

---

## 📋 ראו רשימת חשבונות

אם אתם רוצים לראות את כל החשבונות שהוספתם:

1. כנסו ל-**Actions** → **List Accounts**
2. לחצו **Run workflow**
3. בתום הריצה, יוצג:
   - Account ID
   - שם הבנק
   - תאריך יצירה
   - תאריך עדכון אחרון

---

## 🤖 סריקה אוטומטית

ה-workflow `scrape-transactions` יתנהל אוטומטית **כל יום בשעה 8 בבוקר UTC** (10 בבוקר בשעון ישראל).

אם תרצו לשנות את השעה:

1. פתחו `.github/workflows/scrape-transactions.yml`
2. ערכו את השורה:
   ```yaml
   - cron: '0 8 * * *'
   ```
   - `0 8` = 8:00 בבוקר UTC
   - `* * *` = כל יום

### דוגמה: סריקה בשעה 6 בבוקר UTC

```yaml
- cron: '0 6 * * *'
```

### דוגמה: סריקה רק ביום שישי

```yaml
- cron: '0 8 * * 5'  # יום שישי = 5
```

---

## 📁 אירכוב תוצאות

לאחר כל סריקה, GitHub שומר את הResults ב-**Artifacts**:

1. כנסו ל-**Actions** → בחרו את ה-workflow שרץ
2. בתחתית, תראו **Artifacts**
3. לחצו להוריד את `scraping-results-<account-id>.json`

הקובץ מכיל:
```json
{
  "success": true,
  "accountId": "...",
  "scrapingMode": "regular",
  "transactionsSaved": 42,
  "completedAt": "2024-01-15T10:30:00Z"
}
```

---

## 🔍 Troubleshooting

### בעיה: "Account not found"
**פתרון:** בדוקו שה-Account ID נכון - הריצו "List Accounts"

### בעיה: "Connection test failed"
**פתרון:** 
- בדוקו שהנתונים נכונים
- אם הבנק דורש OTP, עשויה להיות בעיה עם האוטומציה
- נסו לעדכן את הסיסמה/התנתונים

### בעיה: "No transactions found"
**סיבה אפשרית:**
- אין עסקאות בתקופה הנבחרת
- אין גישה לחשבון

### בעיה: Workflow נכשל עם Supabase error
**פתרון:**
- בדוקו שה-Secrets נוספו בנכון: `SUPABASE_URL` ו-`SUPABASE_KEY`
- בדוקו שהטבלאות קיימות ב-Supabase
- תוקדו RLS policies

---

## 💡 טיפים ושימוש אופטימלי

### 1. שמרו את Account IDs
```
בנק הפועלים: 12345678-1234-1234-1234-123456789012
בנק לאומי: 87654321-4321-4321-4321-210987654321
```

### 2. סריקה ראשונית
```
1. הוסיפו חשבון
2. בחרו "Deep" לסריקה ראשונית (כל ההיסטוריה)
3. בהמשך, השתמשו ב-"Update" או "Regular"
```

### 3. תזמון סריקות
- דוגמה: סריקה עמוקה בשעות הלילה (גם כן גדול), update בבוקר

---

## 📞 עזרה וליווי

אם נתקלתם בבעיה:

1. בדוקו את ה-**Workflow logs** בקובץ Actions
2. בדוקו את ה-**Artifacts** להורדת תיעוד שגיאות
3. פתרו בעזרת הטבלה ב-SUPABASE_SETUP.md

---

## 🎯 דוגמה לשימוש שלם

```
1. הוספת חשבון בנק הפועלים
   ✓ Account ID: abc-123

2. סריקה ראשונית (Deep)
   ✓ 500 עסקאות שנשמרו

3. סריקה יומית (Update)
   ✓ 10 עסקאות חדשות כל יום

4. בדיקת עסקאות ב-Supabase Dashboard
   ✓ שכן וברור ב-transactions table
```
